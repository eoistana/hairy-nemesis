<?xml version="1.0" encoding="utf-8" ?>
<Module name="Core.Authentification"
        xmlns="engine"
        xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <Using module="Core.Types"/>

  <Data name="Character">
    <Field name="Name" type="string"/>
    <Key>
      <FieldRef ref="Name"/>
    </Key>
  </Data>

  <Data name="User">
    <Field name="Name" type="string" description="The username"/>
    <Field name="Password" type="string" description="The password. Stored in plain text for now."/>

    <List name="Characters" type="Dictionary" description="The list of characters">
      <Element name="character" type="Character"/>
    </List>
    <Required>
      <FieldRef ref="Password"/>
    </Required>
    <Key>
      <FieldRef ref="Name"/>
    </Key>
  </Data>

  <Data name="UserList" singleton="true">
    <Summary>
      Singleton class for the list of users
    </Summary>
    <List name="Users" type="Dictionary">
      <Element name="user" type="User"/>
    </List>
    <Messages>
      <MessageRef ref="LoginUser" handled="Directly"/>
    </Messages>
  </Data>

  <Data name="LoginToken">
    <Summary>
      Session token
    </Summary>
    <Field name="Token" type="string"/>
  </Data>

  <Message name="LoginUser" expose="true">
    <Summary>
      Send this message to request a user login
    </Summary>
    <Parameter name="Name" type="string"/>
    <Parameter name="Password" type="string"/>
    <Returns dataref="LoginToken" returnmethod="Synchronized"/>
  </Message>
  
  
</Module>